# Инструкция по деплою на PythonAnywhere

## Подготовка файлов для загрузки

1. Запустите скрипт `test_app.py` для проверки локальной версии:
   ```bash
   python test_app.py
   ```

2. Убедитесь, что все проверки пройдены успешно. Если нет, исправьте обнаруженные проблемы.

3. Соберите архив для деплоя:
   ```bash
   python prepare_deploy.py
   ```

4. Архив `web_app_deploy.zip` будет создан в родительской директории.

## Загрузка на PythonAnywhere

1. Войдите в свою учетную запись на PythonAnywhere.

2. Перейдите в раздел "Files" (Файлы).

3. Создайте директорию для вашего приложения, например:
   ```
   mkdir -p mysite/docx_control
   ```

4. Загрузите архив в созданную директорию.

5. Распакуйте архив:
   ```
   cd mysite/docx_control
   unzip ../../web_app_deploy.zip
   ```

## Настройка виртуального окружения

1. Создайте новое виртуальное окружение:
   ```
   mkvirtualenv --python=/usr/bin/python3.8 docx_control_env
   ```

2. Установите необходимые зависимости:
   ```
   pip install -r requirements.txt
   ```

## Настройка веб-приложения

1. В панели управления PythonAnywhere перейдите в раздел "Web".

2. Нажмите кнопку "Add a new web app" (Добавить новое веб-приложение).

3. Выберите свой домен (например, username.pythonanywhere.com).

4. На странице "Select a Python Web framework" выберите "Flask".

5. В поле "Python version" выберите версию Python (3.8 или выше).

6. В поле "Path to your Flask app" укажите путь к вашему WSGI файлу:
   ```
   /home/username/mysite/docx_control/wsgi.py
   ```

7. Укажите ваше виртуальное окружение:
   ```
   docx_control_env
   ```

## Проверка и устранение проблем

1. Перейдите по ссылке `/debug` вашего приложения для проверки состояния:
   ```
   https://username.pythonanywhere.com/debug
   ```

2. Проверьте, что все директории и файлы правильно отображаются.

3. Если возникли проблемы, посмотрите логи ошибок в разделе "Web" PythonAnywhere.

4. Тестовую загрузку файла можно выполнить по адресу:
   ```
   https://username.pythonanywhere.com/debug/test-upload
   ```

## Решение распространенных проблем

### 1. Проблема с путями к файлам

Если приложение не может найти файлы, проверьте:
- Корректно ли указан базовый путь (`BASE_DIR`) в app.py
- Создана ли директория uploads и есть ли права на запись

### 2. Ошибки импорта

Если возникают ошибки импорта:
- Убедитесь, что все зависимости установлены в виртуальном окружении
- Проверьте версии Python в виртуальном окружении и в настройках веб-приложения

### 3. Проблемы с загрузкой файлов

Если загрузка файлов не работает:
- Проверьте права доступа к директории uploads
- Убедитесь, что в настройках PythonAnywhere указан правильный путь к приложению
- Проверьте максимальный размер файла в настройках Flask и PythonAnywhere

### 4. Проблемы с wsgi.py

Если приложение не запускается:
- Проверьте, что wsgi.py содержит правильный импорт приложения: `from app import app as application`
- Убедитесь, что путь к приложению добавлен в sys.path

## Перезапуск приложения

После внесения любых изменений не забывайте перезапускать веб-приложение:
1. В панели управления PythonAnywhere перейдите в раздел "Web".
2. Нажмите кнопку "Reload" (Перезагрузить) для вашего приложения. 